# User Storage REST API (unsecured)

The following project is a REST API example developed using Java17 + SpringBoot 3 and its objective is to show how can we register users using an H2 in memory database (that will be autogenerated)

You will require:
- Java 11
- Maven 3+
- Postman (optional for testing, you can also use http request file for IntellijIDEA Ultimate or any of your preferred Web clients)

If you have more than one version of Java in your computer and you struggle changing ENV variables manually, you can try my PowerShell script to ease the pain :)

https://github.com/malveous/scripting-tools/blob/main/jdk-switcher.ps1

You must change the java paths according to your java installation paths, you can also add more java versions if required.

Tip: You may need to make sure Execution Policy is enabled

```bash
Get-ExecutionPolicy -List
```

If not, then enable it for your user or Local Machine, you can disable it later, but for development purposes I believe is fine to leave it enabled

```bash
Set-ExecutionPolicy Unrestricted -Scope LocalMachine
```

## Installation

You clone the project into a local directory using the regular git clone command

```bash
git clone https://github.com/malveous/userstorage.git
```

Then you can switch to the project directory userstorage and run the regular maven commands in your terminal or either import it to your favorite IDE

```bash
mvn clean package install
```

## Usage

Once the project is imported to your IDE make sure you are using Java 17 version or if you are using the terminal or command line, make sure JAVA_HOME is set to version 17

```bash
java -version
```

Then you can run the SpringBoot application (Run as in your IDE) or just with regular java execution command

## Testing

There are two endpoints, one for signing up a new user and another one to log in

### Sign Up

You can test this endpoint using Postman or any HTTP client (if your IDE support HTTP request clients, you can use the following JSON payload)

The default URL would be: http://localhost:8081/api/v1/user/sing-up

```json
{
  "name": "Marcelo Tataje",
  "email": "carlos.tataje@globallogic.com",
  "password": "C0mpl3j0!",
  "phones": [
    {
      "number": "993788426",
      "cityCode": "1",
      "countryCode": "51"
    },
    {
      "number": "769826",
      "cityCode": "42",
      "countryCode": "45"
    }
  ]
}
```

Consider the following validations were set up in place:
- Name is mandatory
- Email is mandatory and should follow the regular email format, i.e something@emailclient.com
- Password must contain at least 8 characters including an upper case, a lower case, special symbol and number. The maximum length is 12
- If an email is already registered, you cannot register an user with the same email (since we are using an in-memory database, this will apply as long as the application is running)
- Password will be hashed when it is saved to the database ;)

### Log in

You can test this endpoint using Postman or any HTTP client (if your IDE support HTTP request clients, you can use the following JSON payload)

The default URL would be: http://localhost:8081/api/v1/user/login

```json
{
  "token": "eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI4ODQ3MmQ4OS0xZWQ0LTQ2MTItYTk1MS05YmY1MjJhYzI0ZDEiLCJleHAiOjE3MjI0NDk5MzksImlhdCI6MTcyMjQ0OTMzOX0.ZI6PPNEy_jqxT_drKsfRIsUb-SBtH5IIMBbF8-J8eQY"
}
```

Consider using the token you received from the sign-up endpoint and keep in mind this one lasts for 10 minutes. You will need to restart the app, register a different user or increase the expiration time in the application.properties file

## Details

No database script is required since the data model relies in H2 in memory database and it is autogenerated (since it is an example, I found this useful to ease the job of executing DDL commands)

For further API documentation, you can go to: http://localhost:8081/v2/api-docs
A more user friendly version with an UI is also available: http://localhost:8081/swagger-ui/
For interaction with H2 database admin, you can go to: http://localhost:8081/h2-console/

TBD:

- Use SecurityFilterChain to enable security for certain endpoints in the future

## License

[GPL 3.0]([https://choosealicense.com/licenses/mit/](https://www.gnu.org/licenses/gpl-3.0.html))
